<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Introduction to additive models using deep-sea fisheries data | Introduction to GAM using R</title>
  <meta name="description" content="2 Introduction to additive models using deep-sea fisheries data | Introduction to GAM using R" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Introduction to additive models using deep-sea fisheries data | Introduction to GAM using R" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Introduction to additive models using deep-sea fisheries data | Introduction to GAM using R" />
  
  
  

<meta name="author" content="Tsubasa Yamaguchi" />


<meta name="date" content="2023-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter1.html"/>
<link rel="next" href="sessioninfo.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.27/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="custom_style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>本稿の目的</a></li>
<li class="chapter" data-level="" data-path="Chapter0.html"><a href="Chapter0.html"><i class="fa fa-check"></i>0. パッケージの読み込み</a></li>
<li class="chapter" data-level="1" data-path="Chapter1.html"><a href="Chapter1.html"><i class="fa fa-check"></i><b>1</b> Review of multiple linear regressions</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Chapter1.html"><a href="Chapter1.html#light-levels-and-size-of-the-human-visual-system"><i class="fa fa-check"></i><b>1.1</b> Light levels and size of the human visual system</a></li>
<li class="chapter" data-level="1.2" data-path="Chapter1.html"><a href="Chapter1.html#the-variables"><i class="fa fa-check"></i><b>1.2</b> The variables</a></li>
<li class="chapter" data-level="1.3" data-path="Chapter1.html"><a href="Chapter1.html#protocol-for-the-analysis"><i class="fa fa-check"></i><b>1.3</b> Protocol for the analysis</a></li>
<li class="chapter" data-level="1.4" data-path="Chapter1.html"><a href="Chapter1.html#data-exploration"><i class="fa fa-check"></i><b>1.4</b> Data exploration</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="Chapter1.html"><a href="Chapter1.html#欠損値の確認"><i class="fa fa-check"></i><b>1.4.1</b> 欠損値の確認</a></li>
<li class="chapter" data-level="1.4.2" data-path="Chapter1.html"><a href="Chapter1.html#外れ値の確認"><i class="fa fa-check"></i><b>1.4.2</b> 外れ値の確認</a></li>
<li class="chapter" data-level="1.4.3" data-path="Chapter1.html"><a href="Chapter1.html#多重共線性の確認"><i class="fa fa-check"></i><b>1.4.3</b> 多重共線性の確認</a></li>
<li class="chapter" data-level="1.4.4" data-path="Chapter1.html"><a href="Chapter1.html#目的変数と説明変数の関係の確認"><i class="fa fa-check"></i><b>1.4.4</b> 目的変数と説明変数の関係の確認</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="Chapter1.html"><a href="Chapter1.html#multiple-linear-regression"><i class="fa fa-check"></i><b>1.5</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="Chapter1.html"><a href="Chapter1.html#underlying-statistical-theory"><i class="fa fa-check"></i><b>1.5.1</b> Underlying statistical theory</a>
<ul>
<li class="chapter" data-level="1.5.1.1" data-path="Chapter1.html"><a href="Chapter1.html#外れ値のチェック"><i class="fa fa-check"></i><b>1.5.1.1</b> 外れ値のチェック</a></li>
<li class="chapter" data-level="1.5.1.2" data-path="Chapter1.html"><a href="Chapter1.html#信頼区間と予測区間の算出"><i class="fa fa-check"></i><b>1.5.1.2</b> 95%信頼区間と予測区間の算出</a></li>
</ul></li>
<li class="chapter" data-level="1.5.2" data-path="Chapter1.html"><a href="Chapter1.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>1.5.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="1.5.3" data-path="Chapter1.html"><a href="Chapter1.html#fitting-the-model-in-r-and-estimate-parameters"><i class="fa fa-check"></i><b>1.5.3</b> Fitting the model in R and estimate parameters</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="Chapter1.html"><a href="Chapter1.html#finding-the-optimal-model"><i class="fa fa-check"></i><b>1.6</b> Finding the optimal model</a></li>
<li class="chapter" data-level="1.7" data-path="Chapter1.html"><a href="Chapter1.html#degree-of-freedom"><i class="fa fa-check"></i><b>1.7</b> Degree of freedom</a></li>
<li class="chapter" data-level="1.8" data-path="Chapter1.html"><a href="Chapter1.html#c1-8"><i class="fa fa-check"></i><b>1.8</b> Model validation</a></li>
<li class="chapter" data-level="1.9" data-path="Chapter1.html"><a href="Chapter1.html#model-interpretation"><i class="fa fa-check"></i><b>1.9</b> Model interpretation</a></li>
<li class="chapter" data-level="1.10" data-path="Chapter1.html"><a href="Chapter1.html#what-to-do-if-things-go-wrong"><i class="fa fa-check"></i><b>1.10</b> What to do if things go wrong</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chapter2.html"><a href="Chapter2.html"><i class="fa fa-check"></i><b>2</b> Introduction to additive models using deep-sea fisheries data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Chapter2.html"><a href="Chapter2.html#impact-of-deep-sea-fisheries"><i class="fa fa-check"></i><b>2.1</b> Impact of deep-sea fisheries</a></li>
<li class="chapter" data-level="2.2" data-path="Chapter2.html"><a href="Chapter2.html#first-encounter-with-smoothers"><i class="fa fa-check"></i><b>2.2</b> First encounter with smoothers</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="Chapter2.html"><a href="Chapter2.html#applying-linear-regression"><i class="fa fa-check"></i><b>2.2.1</b> Applying linear regression</a>
<ul>
<li class="chapter" data-level="2.2.1.1" data-path="Chapter2.html"><a href="Chapter2.html#当てはめるモデル"><i class="fa fa-check"></i><b>2.2.1.1</b> 当てはめるモデル</a></li>
<li class="chapter" data-level="2.2.1.2" data-path="Chapter2.html"><a href="Chapter2.html#data-exploration-1"><i class="fa fa-check"></i><b>2.2.1.2</b> data exploration</a></li>
<li class="chapter" data-level="2.2.1.3" data-path="Chapter2.html"><a href="Chapter2.html#model-diagnosis"><i class="fa fa-check"></i><b>2.2.1.3</b> model diagnosis</a></li>
</ul></li>
<li class="chapter" data-level="2.2.2" data-path="Chapter2.html"><a href="Chapter2.html#applying-cubic-polynomials"><i class="fa fa-check"></i><b>2.2.2</b> Applying cubic polynomials</a></li>
<li class="chapter" data-level="2.2.3" data-path="Chapter2.html"><a href="Chapter2.html#a-simple-gam"><i class="fa fa-check"></i><b>2.2.3</b> A simple GAM</a></li>
<li class="chapter" data-level="2.2.4" data-path="Chapter2.html"><a href="Chapter2.html#moving-average-and-loess-smoother"><i class="fa fa-check"></i><b>2.2.4</b> Moving average and LOESS smoother</a>
<ul>
<li class="chapter" data-level="2.2.4.1" data-path="Chapter2.html"><a href="Chapter2.html#移動平均"><i class="fa fa-check"></i><b>2.2.4.1</b> 移動平均</a></li>
<li class="chapter" data-level="2.2.4.2" data-path="Chapter2.html"><a href="Chapter2.html#局所回帰loess"><i class="fa fa-check"></i><b>2.2.4.2</b> 局所回帰(LOESS)</a></li>
</ul></li>
<li class="chapter" data-level="2.2.5" data-path="Chapter2.html"><a href="Chapter2.html#packages-for-smoothing"><i class="fa fa-check"></i><b>2.2.5</b> 2.2.5 Packages for smoothing</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Chapter2.html"><a href="Chapter2.html#allpying-gam-in-r-using-the-mgcv-package"><i class="fa fa-check"></i><b>2.3</b> 2.3 Allpying GAM in R using the mgcv package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sessioninfo.html"><a href="sessioninfo.html"><i class="fa fa-check"></i>実行環境</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to GAM using R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-additive-models-using-deep-sea-fisheries-data" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Introduction to additive models using deep-sea fisheries data<a href="Chapter2.html#introduction-to-additive-models-using-deep-sea-fisheries-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>本章では、正規分布に従う一般化加法モデル(GAM)の導入を行う。</p>
<div id="impact-of-deep-sea-fisheries" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Impact of deep-sea fisheries<a href="Chapter2.html#impact-of-deep-sea-fisheries" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本章では、商業的な漁業が深海(水深800~4865m)の魚の密度に及ぼす影響を調べた <span class="citation">Bailey et al. (<a href="#ref-Bailey2009">2009</a>)</span> のデータを用いる。データは2つの期間に分かれており、1979<sub>1989年は商業的な漁業がおこなわれる前(深い水深での漁業が発展している段階)で、1997</sub>2002年は商業的漁業がおこなわれている時期である。商業的漁業は技術的または商業的な理由により水深約1600mまでに限られている。</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="Chapter2.html#cb49-1" tabindex="-1"></a>fish <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">&quot;data/BaileyDensity.txt&quot;</span>)</span>
<span id="cb49-2"><a href="Chapter2.html#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="Chapter2.html#cb49-3" tabindex="-1"></a><span class="fu">datatable</span>(fish,</span>
<span id="cb49-4"><a href="Chapter2.html#cb49-4" tabindex="-1"></a>          <span class="at">options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="dv">20</span>),</span>
<span id="cb49-5"><a href="Chapter2.html#cb49-5" tabindex="-1"></a>          <span class="at">filter =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b0497af47c5a1af7fb77" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b0497af47c5a1af7fb77">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"148\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"1230\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1.48e-05\" data-max=\"0.030923947\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"804\" data-max=\"4865\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1977\" data-max=\"2002\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-429.8221529\" data-max=\"107.1441892\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-496.8108315\" data-max=\"203.9148935\" data-scale=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"7970\" data-max=\"223440\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148],[76,161,39,410,177,695,352,674,624,736,332,529,355,178,60,276,54,264,103,347,168,205,1230,100,332,636,665,205,392,141,567,185,402,522,72,212,421,233,249,1026,185,243,80,488,151,26,1003,680,225,537,639,168,271,31,315,135,376,669,191,303,467,44,387,320,161,173,166,49,534,5,105,235,267,117,147,136,107,228,108,469,211,39,301,155,136,341,240,138,90,90,143,291,234,192,269,227,196,71,217,242,121,133,174,155,150,61,187,119,55,71,57,84,5,100,25,88,35,62,152,17,130,27,11,37,35,54,64,26,2,56,47,31,4,23,12,26,10,35,105,12,7,4,10,20,13,24,38,29],[0.002070281,0.003519799,0.000980515,0.008039216,0.005933375,0.021800502,0.009190601,0.017616309,0.013991031,0.013992395,0.011129268,0.013258145,0.009683579,0.005310263,0.001345291,0.005411765,0.001559342,0.006637335,0.002589566,0.008381643,0.004223759,0.002945137,0.030923947,0.012547051,0.008346952,0.020997029,0.014393939,0.005137845,0.008197407,0.004422836,0.013695652,0.004651163,0.008304069,0.012608696,0.001974744,0.005313283,0.006771755,0.00468636,0.006508102,0.020765027,0.004004329,0.005639414,0.001340876,0.013311511,0.002530903,0.000871569,0.023303903,0.015236388,0.005058453,0.012090396,0.016701516,0.004582651,0.004542216,0.00056341,0.00706278,0.003383459,0.008430493,0.015,0.004134199,0.007039963,0.009156863,0.000890508,0.011035073,0.003716609,0.00420805,0.00325188,0.004105058,0.001012188,0.009571608,9.04e-05,0.000772639,0.005269058,0.008375157,0.006525376,0.006148055,0.002279489,0.002211067,0.003488906,0.001357637,0.004353476,0.002941587,0.000588309,0.003596177,0.002487396,0.002501878,0.00648289,0.002549552,0.002111706,0.001508485,0.001508485,0.003536285,0.004593528,0.003191489,0.003441477,0.004508694,0.004280327,0.003322034,0.00089252,0.002617612,0.002376043,0.002599356,0.001702727,0.000778733,0.001800232,0.002631079,0.000933435,0.002495996,0.001994553,0.000691389,0.001020023,0.000574192,0.000959945,6.15e-05,0.001041124,0.000490196,0.000935673,0.000562972,0.000505133,0.001032837,0.000221903,0.001089461,0.000332144,0.000106167,0.000772765,0.000643146,0.000452546,0.000647577,0.00023071,1.48e-05,0.000575954,0.000508383,0.00046763,5.01e-05,0.000288582,0.00017508,0.000250965,0.000140376,0.000381388,0.000998099,7.78e-05,6.79e-05,2.65e-05,8.62e-05,0.000155916,8.16e-05,0.000264026,0.000273973,0.00021658],[804,808,809,848,853,960,977,982,985,986,1000,1016,1017,1024,1025,1027,1036,1053,1065,1100,1110,1144,1200,1205,1212,1217,1257,1263,1265,1272,1284,1300,1312,1360,1368,1379,1390,1430,1440,1448,1452,1462,1500,1506,1519,1521,1524,1527,1533,1541,1587,1600,1642,1648,1650,1677,1700,1720,1742,1789,1790,1845,1867,1872,1884,1900,1909,1927,1932,1944,1946,1975,1987,1993,2015,2016,2058,2078,2114,2122,2172,2204,2230,2287,2292,2397,2410,2420,2434,2450,2462,2477,2486,2487,2500,2504,2530,2572,2645,2670,2737,2855,2875,2970,3048,3066,3089,3099,3126,3138,3485,3639,3677,3753,3810,3900,3985,3995,4001,4016,4020,4056,4062,4073,4118,4127,4222,4226,4242,4245,4292,4298,4320,4375,4510,4565,4765,4787,4800,4810,4811,4812,4812,4840,4842,4846,4846,4865],[1978,2001,2001,1979,2002,1980,1981,1979,1982,1980,2002,1983,1979,1978,1981,1980,1978,2001,2001,1979,2002,2001,2002,1981,2001,1982,1980,1979,1980,1981,1982,2002,1980,1981,2001,1981,1979,2002,1982,1979,1982,2001,2001,1979,2001,2001,1981,1982,1978,2000,1981,1979,2001,2001,1980,1979,1982,1983,1982,1979,1981,1980,1981,1979,1980,1979,2000,1981,1979,1978,2001,1982,1981,1981,1981,2002,2000,1979,2002,1980,1981,2002,1982,2001,2001,1981,2002,1979,2001,2001,2000,1982,1982,1983,2002,2001,1981,2002,1980,1982,1979,1982,1980,1980,2000,1979,1983,2002,2002,2001,1982,2001,1980,1977,1981,1981,1981,1983,2000,1978,2001,1979,1980,1977,1978,2001,1982,2002,1981,1982,1980,2001,1982,1980,1979,1984,2002,1979,1984,2002,2002,2002,2002,2000,1986,1989,1989,1989],[1,2,2,1,2,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,2,2,2,1,2,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,1,2,2,1,2,2,1,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,2,2,1,2,1,1,2,1,2,2,1,2,1,2,2,2,1,1,1,2,2,1,2,1,1,1,1,1,1,2,1,1,2,2,2,1,2,1,1,1,1,1,1,2,1,2,1,1,1,1,2,1,2,1,1,1,2,1,1,1,1,2,1,1,2,2,2,2,2,1,1,1,1],[98.75575222,76.80387976,103.792826,91.53226694,107.1441892,86.56469785,84.2175715,90.47901492,-5.727701468,-4.585552076,75.90372422,80.608247,-16.11460992,90.47209563,-5.738294398,-31.26044392,64.15523081,92.15434888,88.57575039,-75.19858864,77.14068591,45.74594153,75.64458935,0,81.57533715,9.188045076,-26.67766922,63.59061622,58.89197156,60.19642256,1.151466213,65.63528076,-4.605864854,-1.151888764,22.32195649,11.50197978,-17.37954436,57.89880205,37.30906912,14.4520613,-1.155687327,39.32517011,5.778856565,-18.57183604,11.18928745,35.65523912,6.913867301,-5.793181452,71.06129762,65.21470034,26.4593531,31.27014457,58.83082612,9.361981947,22.84346193,3.475908871,0,33.58824381,-2.3223203,-22.87464057,35.917725,17.39216954,24.01289723,-18.62560291,28.80561493,-33.67554031,71.97467262,-34.84252471,-4.658079172,56.11819205,-14.14869269,45.43687708,5.801596281,76.23793255,10.48445375,-1.919322071,-38.70740923,-25.30832046,-12.46447322,-12.85121037,53.97220499,33.12679882,2.34578254,46.6860626,7.783608726,27.40637491,20.51082894,-1.17831146,8.964095492,-10.16491295,3.777718812,4.779531781,1.180391666,2.387291335,17.01124515,7.866346295,4.776232777,-1.194718027,-23.61614815,-28.42906997,-24.9363589,-37.1571248,-37.87887358,-35.83411861,-40.99205904,-40.3309001,-31.03478735,-36.86324929,-51.31528586,-40.74410256,-69.03982546,-83.18070992,-79.47559725,-59.51709091,-78.64438019,-68.13182463,-78.94387466,-57.65067198,null,-77.74775535,-118.9969732,-74.31253754,-92.00598678,-80.11238854,-88.54331126,-77.59084947,-72.13724821,-90.60525211,-78.17536143,-83.90125206,-119.6119313,-100.1776926,-108.1689273,-112.860617,-148.6250751,-429.8221529,-175.4220352,-186.3374168,-178.180201,-240.6486394,-226.2229457,-272.4072996,-261.4873989,-275.2878982,-215.8402009,-259.1226501,-255.2863104,-248.7649773],[-57.46692454,178.6479844,-50.0518375,146.447969,-37.07543519,-48.19806574,-51.90560926,-66.73578333,203.9148935,200.20735,161.0927659,-51.90560926,179.8158606,140.8866537,194.6460347,150.1555125,-85.27350093,-29.10421662,-31.51411991,74.15087037,-36.51930366,-79.71218565,139.5890135,185.3771759,-20.39148935,190.9384912,140.8866537,-37.07543519,-46.34429398,-55.61315278,177.9620889,-17.79620889,177.9620889,176.1083171,-61.76767502,183.5234042,146.447969,-43.37825917,-53.75938102,-57.46692454,159.4243713,159.7951256,-55.61315278,137.1791102,-52.09098644,162.3904061,174.2545454,146.447969,118.6413926,127.7063365,-50.0518375,-50.0518375,-18.72309477,-45.97353963,-48.19806574,146.447969,140.8866537,148.3017407,135.3253384,-55.61315278,146.447969,142.7404255,-40.7829787,122.3489361,-38.92920694,-50.0518375,99.88122239,-44.49052222,120.4951644,100.103675,-33.55326884,-18.53771759,139.0328819,83.41972917,118.6413926,-35.96317213,-43.95292841,-61.17446806,-31.14336556,103.8112185,81.56595741,-19.46460347,83.41972917,-10.93725338,-26.50893616,0,-4.07829787,59.3206963,-16.31319148,-19.2792263,-17.51814312,-14.83017407,50.0518375,-9.268858796,8.898104444,-1.297640231,-11.12263056,-14.08866537,48.19806574,31.51411991,18.53771759,135.3253384,35.22166343,-12.97640231,-9.565462278,24.09903287,-9.268858796,-6.302823981,-20.57686653,-14.6447969,5.561315278,22.31941198,24.09903287,5.561315278,0,-16.68394583,-20.39148935,-42.63675046,null,-20.39148935,7.229709861,-31.51411991,-14.83017407,-18.53771759,-22.24526111,-42.82212764,-48.19806574,-38.18769824,-50.0518375,-31.51411991,-20.39148935,-51.6275435,-46.34429398,-40.7829787,-31.51411991,-496.8108315,-63.39899417,-12.97640231,-248.4054157,-116.0461121,-120.4951644,-148.3017407,-142.5550483,-123.3499729,-126.0564796,-139.0328819,-135.3253384,-126.0564796],[36710,45741.25391,39775,51000,29831.25195,31880,38300,38260,44600,52600,29831.25195,39900,36660,33520,44600,51000,34630,39775,39775,41400,39775,69606.25781,39775,7970,39775,30290,46200,39900,47820,31880,41400,39775,48410,41400,36460.41797,39900,62170,49718.75391,38260,49410,46200,43089.58594,59662.50391,36660,59662.50391,29831.25195,43040,44630,44480,44415.41797,38260,36660,59662.50391,55022.08594,44600,39900,44600,44600,46200,43040,51000,49410,35070,86100,38260,53200,40437.91406,48410,55790,55330,135897.9219,44600,31880,17930,23910,59662.50391,48392.91797,65350,79550,107730,71730,66291.67188,83700,62314.17188,54359.16797,52600,94134.17188,65350,59662.50391,59662.50391,40437.91406,63350,73320,55790,59662.50391,53033.33203,59000,79550,82900,101850,46550,78110,223440,86100,57010.83203,65350,74920,59662.50391,79550,69606.25781,99270,87505.00781,81290,96050,51000,94050,62170,122740,147167.5,76610,119325.0078,81290,103610,47880,54420,119325,98830,112695.8359,135490,97230,92450,66291.67188,79920,79700,68540,103600,71237.03125,91770,105200,154323.0313,103096.8047,150707.4688,115983.8984,128274.3828,159400,90900,138700,133900]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Site<\/th>\n      <th>TotAbund<\/th>\n      <th>Dens<\/th>\n      <th>MeanDepth<\/th>\n      <th>Year<\/th>\n      <th>Period<\/th>\n      <th>Xkm<\/th>\n      <th>Ykm<\/th>\n      <th>SweptArea<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":20,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<p><span class="citation">Bailey et al. (<a href="#ref-Bailey2009">2009</a>)</span> では、魚の密度を以下のように定義している。</p>
<p><span class="math display">\[
場所iにおける魚の密度 = \frac{場所iの魚の総量}{場所iで探索を行った面積}
\]</span></p>
<p>密度のような割り算データを目的変数にして正規分布に当てはめると、等分散性の問題が生じることが多い。通常、このような分子が整数値の割り算データに対してはポワソン分布や負の二項分布でオフセット項を用いる(第4章を参照)。もし分母が試行数、分子が成功数などのカウントデータの場合は二項分布を当てはめた方がよい。密度が0より大きい値しかとらないのであれば、ガンマ分布を当てはめることもできる。</p>
</div>
<div id="first-encounter-with-smoothers" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> First encounter with smoothers<a href="Chapter2.html#first-encounter-with-smoothers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="applying-linear-regression" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Applying linear regression<a href="Chapter2.html#applying-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="当てはめるモデル" class="section level4 hasAnchor" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> 当てはめるモデル<a href="Chapter2.html#当てはめるモデル" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>全種を含めた魚の密度は以下のように表せる。なお<span class="math inline">\(i\)</span>は場所を、<span class="math inline">\(j\)</span>は魚の種類を表す。また、<span class="math inline">\(SA_i\)</span>は場所<span class="math inline">\(i\)</span>における探索面積を、<span class="math inline">\(Y_{ij}\)</span>は場所<span class="math inline">\(i\)</span>における種<span class="math inline">\(j\)</span>の捕獲個体数を表す。
<span class="math display">\[
Dens_i = \frac{\sum_j Y_{ij}}{SA_i}
\]</span></p>
<p>まずは、各探索場所の深さのみが魚の密度に影響するとする線形なモデルを考える。モデル式は以下のようになる。</p>
<p><span class="math display">\[
\begin{aligned}
Dens_i &amp;= \alpha + \beta \times Depth_i + \epsilon_i \\
\epsilon_i &amp;\sim N(0,\sigma^2)
\end{aligned}
\]</span></p>
</div>
<div id="data-exploration-1" class="section level4 hasAnchor" number="2.2.1.2">
<h4><span class="header-section-number">2.2.1.2</span> data exploration<a href="Chapter2.html#data-exploration-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>いかなるモデルを作ろうとも、まずはデータ探索を行う。まずは、水深と魚の密度の関連をプロットする(図<a href="Chapter2.html#fig:fig-depth-density">2.1</a>)。図から明らかに水深と魚の密度の関係は線形ではない。しかし、ここではこうしたデータが線形モデルの前提を満たさないことを示すため、まずは通常の線形モデルを適用する。</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="Chapter2.html#cb50-1" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="Chapter2.html#cb50-2" tabindex="-1"></a>  <span class="fu">filter</span>(MeanDepth <span class="sc">&gt;</span> <span class="dv">800</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="Chapter2.html#cb50-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year01 =</span> <span class="fu">ifelse</span>(Year <span class="sc">&gt;</span> <span class="dv">1990</span>, <span class="st">&quot;commercial&quot;</span>,<span class="st">&quot;non-commercial&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb50-4"><a href="Chapter2.html#cb50-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> Dens))<span class="sc">+</span></span>
<span id="cb50-5"><a href="Chapter2.html#cb50-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> year01))<span class="sc">+</span></span>
<span id="cb50-6"><a href="Chapter2.html#cb50-6" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">19</span>,<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-7"><a href="Chapter2.html#cb50-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb50-8"><a href="Chapter2.html#cb50-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb50-9"><a href="Chapter2.html#cb50-9" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-10"><a href="Chapter2.html#cb50-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean sampling depth (m)&quot;</span>,</span>
<span id="cb50-11"><a href="Chapter2.html#cb50-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-depth-density"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-depth-density-1.png" alt="Relationship between fish density and mean sampling depth. Filled circles are observations from the second period and open circles from the first period." width="432" />
<p class="caption">
図2.1: Relationship between fish density and mean sampling depth. Filled circles are observations from the second period and open circles from the first period.
</p>
</div>
<p>モデルは以下のように実行できる。モデルは、目的変数のばらつきの33.7%が水深で説明できると推定している(<code>Adjusted R-squared</code>より)。</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="Chapter2.html#cb51-1" tabindex="-1"></a>M2_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Dens <span class="sc">~</span> MeanDepth, <span class="at">data =</span> fish)</span>
<span id="cb51-2"><a href="Chapter2.html#cb51-2" tabindex="-1"></a></span>
<span id="cb51-3"><a href="Chapter2.html#cb51-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(M2_1), <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Dens ~ MeanDepth, data = fish)
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.007833 -0.002518 -0.000526  0.001409  0.023109 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.09e-02   8.02e-04   13.57  &lt; 2e-16 ***
## MeanDepth   -2.55e-06   2.94e-07   -8.69  6.6e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.00448 on 146 degrees of freedom
## Multiple R-squared:  0.341,  Adjusted R-squared:  0.337 
## F-statistic: 75.6 on 1 and 146 DF,  p-value: 6.61e-15</code></pre>
</div>
<div id="model-diagnosis" class="section level4 hasAnchor" number="2.2.1.3">
<h4><span class="header-section-number">2.2.1.3</span> model diagnosis<a href="Chapter2.html#model-diagnosis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>それでは、モデル診断を行おう。</p>
<p>まずは標準化残差とモデルの予測値の関係を見る(図<a href="Chapter2.html#fig:fig-diafnosisM2-1">2.2</a>のA)。明らかにパターンが見て取れ、モデルが等分散性の仮定を満たしていないことが分かる。また、水深と標準化残差にもパターンがあるように見え(図<a href="Chapter2.html#fig:fig-diafnosisM2-1">2.2</a>のB)、このモデルでは水深でうまく目的変数を説明できていないことが分かる。</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="Chapter2.html#cb53-1" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">resstd =</span> <span class="fu">rstandard</span>(M2_1),</span>
<span id="cb53-2"><a href="Chapter2.html#cb53-2" tabindex="-1"></a>           <span class="at">fitted =</span> <span class="fu">fitted</span>(M2_1)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="Chapter2.html#cb53-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resstd))<span class="sc">+</span></span>
<span id="cb53-4"><a href="Chapter2.html#cb53-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-5"><a href="Chapter2.html#cb53-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb53-6"><a href="Chapter2.html#cb53-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb53-7"><a href="Chapter2.html#cb53-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb53-8"><a href="Chapter2.html#cb53-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Standardized residuals&quot;</span>,</span>
<span id="cb53-9"><a href="Chapter2.html#cb53-9" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;A&quot;</span>) <span class="ot">-&gt;</span> p_diag_M2_1_a</span>
<span id="cb53-10"><a href="Chapter2.html#cb53-10" tabindex="-1"></a></span>
<span id="cb53-11"><a href="Chapter2.html#cb53-11" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">resstd =</span> <span class="fu">rstandard</span>(M2_1),</span>
<span id="cb53-12"><a href="Chapter2.html#cb53-12" tabindex="-1"></a>           <span class="at">depth =</span> fish<span class="sc">$</span>MeanDepth) <span class="sc">%&gt;%</span> </span>
<span id="cb53-13"><a href="Chapter2.html#cb53-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> depth, <span class="at">y =</span> resstd))<span class="sc">+</span></span>
<span id="cb53-14"><a href="Chapter2.html#cb53-14" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-15"><a href="Chapter2.html#cb53-15" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb53-16"><a href="Chapter2.html#cb53-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb53-17"><a href="Chapter2.html#cb53-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb53-18"><a href="Chapter2.html#cb53-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Standardized residuals&quot;</span>,</span>
<span id="cb53-19"><a href="Chapter2.html#cb53-19" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;B&quot;</span>) <span class="ot">-&gt;</span> p_diag_M2_1_b</span>
<span id="cb53-20"><a href="Chapter2.html#cb53-20" tabindex="-1"></a></span>
<span id="cb53-21"><a href="Chapter2.html#cb53-21" tabindex="-1"></a>p_diag_M2_1_a <span class="sc">+</span> p_diag_M2_1_b</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-diafnosisM2-1"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-diafnosisM2-1-1.png" alt="A. Standardized residuals versus fitted values to assess homogeneity. B. Residuals versus mean depth." width="672" />
<p class="caption">
図2.2: A. Standardized residuals versus fitted values to assess homogeneity. B. Residuals versus mean depth.
</p>
</div>
<p><br/></p>
<p>QQプロットでも標準化残差が標準正規分布に従っていないことが示唆される。</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="Chapter2.html#cb54-1" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rstandard</span>(M2_1))</span>
<span id="cb54-2"><a href="Chapter2.html#cb54-2" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">rstandard</span>(M2_1))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-qqplot-M2-1"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-qqplot-M2-1-1.png" alt="QQplot for M2_1" width="432" />
<p class="caption">
図2.3: QQplot for M2_1
</p>
</div>
<p>残差に見られたパターンは、明らかに非線形なデータに直線的なモデルを当てはめているために生じている。図<a href="Chapter2.html#fig:fig-fitted-M2-1">2.4</a>からわかるように、水深2000m以上ではモデルに基づく回帰直線がほとんどデータの上に来てしまっている。また、水深約4000m以上では予測値がマイナスになってしまっている。</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="Chapter2.html#cb55-1" tabindex="-1"></a>dataM2_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>,<span class="dv">5000</span>,<span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb55-2"><a href="Chapter2.html#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="Chapter2.html#cb55-3" tabindex="-1"></a>pred_M2_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2_1,</span>
<span id="cb55-4"><a href="Chapter2.html#cb55-4" tabindex="-1"></a>                    <span class="at">newdata =</span> dataM2_1) <span class="sc">%&gt;%</span> </span>
<span id="cb55-5"><a href="Chapter2.html#cb55-5" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb55-6"><a href="Chapter2.html#cb55-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pred =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="Chapter2.html#cb55-7" tabindex="-1"></a>  <span class="fu">bind_cols</span>(dataM2_1)</span>
<span id="cb55-8"><a href="Chapter2.html#cb55-8" tabindex="-1"></a></span>
<span id="cb55-9"><a href="Chapter2.html#cb55-9" tabindex="-1"></a>pred_M2_1 <span class="sc">%&gt;%</span> </span>
<span id="cb55-10"><a href="Chapter2.html#cb55-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> pred))<span class="sc">+</span></span>
<span id="cb55-11"><a href="Chapter2.html#cb55-11" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb55-12"><a href="Chapter2.html#cb55-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fish,</span>
<span id="cb55-13"><a href="Chapter2.html#cb55-13" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> Dens))<span class="sc">+</span></span>
<span id="cb55-14"><a href="Chapter2.html#cb55-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb55-15"><a href="Chapter2.html#cb55-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb55-16"><a href="Chapter2.html#cb55-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-fitted-M2-1"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-fitted-M2-1-1.png" alt="Fidh density plotted versus depth, with fitted values obtained by linear model." width="432" />
<p class="caption">
図2.4: Fidh density plotted versus depth, with fitted values obtained by linear model.
</p>
</div>
</div>
</div>
<div id="applying-cubic-polynomials" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Applying cubic polynomials<a href="Chapter2.html#applying-cubic-polynomials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>モデルを改善するため、説明変数に水深の二乗、三乗、四乗項を入れるモデルを考える(= 多項式回帰)。このようにすることで非線形な関係をとらえられるかもしれない。</p>
<p><span class="math display">\[
\begin{aligned}
Dens_i &amp;= \alpha + \beta_1 \times Depth_i + \beta_2 \times Depth^2_i + \beta_3 \times Depth^3_i +  \epsilon_i \\
\epsilon_i &amp;\sim N(0,\sigma^2)
\end{aligned}
\]</span></p>
<p>そのようなモデルは以下で実行できる。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="Chapter2.html#cb56-1" tabindex="-1"></a>M2_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Dens <span class="sc">~</span> <span class="fu">poly</span>(MeanDepth, <span class="dv">3</span>), <span class="at">data =</span> fish)</span></code></pre></div>
<p>モデルの診断を行ったのが図<a href="Chapter2.html#fig:fig-diafnosisM2-2">2.5</a>である。明確なパターンがあるように見え(A. 予測値が大きいほどばらつきが大きくなる、B. 水深が浅くなるほどばらつきが大きくなる)、モデルが十分に改善できていないことが分かる。</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="Chapter2.html#cb57-1" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">resstd =</span> <span class="fu">rstandard</span>(M2_2),</span>
<span id="cb57-2"><a href="Chapter2.html#cb57-2" tabindex="-1"></a>           <span class="at">fitted =</span> <span class="fu">fitted</span>(M2_2)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="Chapter2.html#cb57-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> resstd))<span class="sc">+</span></span>
<span id="cb57-4"><a href="Chapter2.html#cb57-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb57-5"><a href="Chapter2.html#cb57-5" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb57-6"><a href="Chapter2.html#cb57-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb57-7"><a href="Chapter2.html#cb57-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb57-8"><a href="Chapter2.html#cb57-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Fitted values&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Standardized residuals&quot;</span>,</span>
<span id="cb57-9"><a href="Chapter2.html#cb57-9" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;A&quot;</span>) <span class="ot">-&gt;</span> p_diag_M2_2_a</span>
<span id="cb57-10"><a href="Chapter2.html#cb57-10" tabindex="-1"></a></span>
<span id="cb57-11"><a href="Chapter2.html#cb57-11" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">resstd =</span> <span class="fu">rstandard</span>(M2_2),</span>
<span id="cb57-12"><a href="Chapter2.html#cb57-12" tabindex="-1"></a>           <span class="at">depth =</span> fish<span class="sc">$</span>MeanDepth) <span class="sc">%&gt;%</span> </span>
<span id="cb57-13"><a href="Chapter2.html#cb57-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> depth, <span class="at">y =</span> resstd))<span class="sc">+</span></span>
<span id="cb57-14"><a href="Chapter2.html#cb57-14" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb57-15"><a href="Chapter2.html#cb57-15" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb57-16"><a href="Chapter2.html#cb57-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb57-17"><a href="Chapter2.html#cb57-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb57-18"><a href="Chapter2.html#cb57-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Standardized residuals&quot;</span>,</span>
<span id="cb57-19"><a href="Chapter2.html#cb57-19" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;B&quot;</span>) <span class="ot">-&gt;</span> p_diag_M2_2_b</span>
<span id="cb57-20"><a href="Chapter2.html#cb57-20" tabindex="-1"></a></span>
<span id="cb57-21"><a href="Chapter2.html#cb57-21" tabindex="-1"></a>p_diag_M2_2_a <span class="sc">+</span> p_diag_M2_2_b</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-diafnosisM2-2"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-diafnosisM2-2-1.png" alt="A. Standardized residuals versus fitted values to assess homogeneity. B. Residuals versus mean depth." width="672" />
<p class="caption">
図2.5: A. Standardized residuals versus fitted values to assess homogeneity. B. Residuals versus mean depth.
</p>
</div>
<p>QQプロットからも標準化残差が標準正規分布に従っていないことが分かる(図<a href="Chapter2.html#fig:fig-qqplot-M2-2">2.6</a>)。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="Chapter2.html#cb58-1" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rstandard</span>(M2_2))</span>
<span id="cb58-2"><a href="Chapter2.html#cb58-2" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">rstandard</span>(M2_2))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-qqplot-M2-2"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-qqplot-M2-2-1.png" alt="QQplot for M2_2" width="432" />
<p class="caption">
図2.6: QQplot for M2_2
</p>
</div>
<p>実測値にモデルに基づく予測値を描いたのが図<a href="Chapter2.html#fig:fig-fitted-M2-2">2.7</a>である。水深4000mあたりで予測値がほとんどの実測値よりも低くなってしまっている。</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="Chapter2.html#cb59-1" tabindex="-1"></a>dataM2_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>,<span class="dv">5000</span>,<span class="at">length.out =</span> <span class="dv">100</span>))</span>
<span id="cb59-2"><a href="Chapter2.html#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="Chapter2.html#cb59-3" tabindex="-1"></a>pred_M2_2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2_2,</span>
<span id="cb59-4"><a href="Chapter2.html#cb59-4" tabindex="-1"></a>                    <span class="at">newdata =</span> dataM2_2) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="Chapter2.html#cb59-5" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="Chapter2.html#cb59-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">pred =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-7"><a href="Chapter2.html#cb59-7" tabindex="-1"></a>  <span class="fu">bind_cols</span>(dataM2_2)</span>
<span id="cb59-8"><a href="Chapter2.html#cb59-8" tabindex="-1"></a></span>
<span id="cb59-9"><a href="Chapter2.html#cb59-9" tabindex="-1"></a>pred_M2_2 <span class="sc">%&gt;%</span> </span>
<span id="cb59-10"><a href="Chapter2.html#cb59-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> pred))<span class="sc">+</span></span>
<span id="cb59-11"><a href="Chapter2.html#cb59-11" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb59-12"><a href="Chapter2.html#cb59-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fish,</span>
<span id="cb59-13"><a href="Chapter2.html#cb59-13" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> Dens))<span class="sc">+</span></span>
<span id="cb59-14"><a href="Chapter2.html#cb59-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb59-15"><a href="Chapter2.html#cb59-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb59-16"><a href="Chapter2.html#cb59-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-fitted-M2-2"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-fitted-M2-2-1.png" alt="Fidh density plotted versus depth, with fitted values obtained by linear model." width="432" />
<p class="caption">
図2.7: Fidh density plotted versus depth, with fitted values obtained by linear model.
</p>
</div>
</div>
<div id="a-simple-gam" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> A simple GAM<a href="Chapter2.html#a-simple-gam" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>モデルを改善するほかの選択肢は、一般化加法モデル(GAM)を用いることである。シンプルなGAMは以下のように書ける。<span class="math inline">\(f(Depth_i)\)</span>は平滑化関数であり、予測値がデータに合うような曲線を描くように推定される。以下では、GAMではどのようにしてこの関数を推定するのかを説明していく。</p>
<p><span class="math display" id="eq:gam">\[
\begin{aligned}
Dens_i &amp;= \alpha + f(Depth_i) +  \epsilon_i \tag{2.1} \\
\epsilon_i &amp;\sim N(0,\sigma^2)
\end{aligned}
\]</span></p>
</div>
<div id="moving-average-and-loess-smoother" class="section level3 hasAnchor" number="2.2.4">
<h3><span class="header-section-number">2.2.4</span> Moving average and LOESS smoother<a href="Chapter2.html#moving-average-and-loess-smoother" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>データに合うように平滑化を行う方法は複数存在するが、比較的単純なものが移動平均とLOESS(局所回帰)である。より複雑な手法については第3方で解説する。</p>
<div id="移動平均" class="section level4 hasAnchor" number="2.2.4.1">
<h4><span class="header-section-number">2.2.4.1</span> 移動平均<a href="Chapter2.html#移動平均" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>移動平均は、推定値を求めたいポイントの前後にある特定の範囲(あるいは個数?)のデータの平均値を推定値とするような方法である。例えば、水深2500mのときの推定値として、その前後500m(2000m ~ 3000m)にあるデータの平均値を用いると、0.00286になる(図<a href="Chapter2.html#fig:fig-movave1">2.8</a>)。</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="Chapter2.html#cb60-1" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="Chapter2.html#cb60-2" tabindex="-1"></a>  <span class="fu">filter</span>(MeanDepth <span class="sc">&gt;=</span> <span class="dv">2000</span> <span class="sc">&amp;</span> MeanDepth <span class="sc">&lt;=</span> <span class="dv">3000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="Chapter2.html#cb60-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Dens)) <span class="ot">-&gt;</span> mean</span>
<span id="cb60-4"><a href="Chapter2.html#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="Chapter2.html#cb60-5" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="Chapter2.html#cb60-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> Dens))<span class="sc">+</span></span>
<span id="cb60-7"><a href="Chapter2.html#cb60-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb60-8"><a href="Chapter2.html#cb60-8" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2000</span>,</span>
<span id="cb60-9"><a href="Chapter2.html#cb60-9" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-10"><a href="Chapter2.html#cb60-10" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">3000</span>,</span>
<span id="cb60-11"><a href="Chapter2.html#cb60-11" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-12"><a href="Chapter2.html#cb60-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2500</span>, <span class="at">y =</span> mean<span class="sc">$</span>mean),</span>
<span id="cb60-13"><a href="Chapter2.html#cb60-13" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">shape =</span> <span class="dv">18</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb60-14"><a href="Chapter2.html#cb60-14" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb60-15"><a href="Chapter2.html#cb60-15" tabindex="-1"></a>           <span class="at">x =</span> <span class="dv">3000</span>, <span class="at">y =</span> mean<span class="sc">$</span>mean <span class="sc">+</span> <span class="fl">0.002</span>,</span>
<span id="cb60-16"><a href="Chapter2.html#cb60-16" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%.5f&quot;</span>,mean<span class="sc">$</span>mean))<span class="sc">+</span></span>
<span id="cb60-17"><a href="Chapter2.html#cb60-17" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">2550</span>, <span class="at">xend =</span> <span class="dv">2900</span>, <span class="at">y =</span> mean<span class="sc">$</span>mean, <span class="at">yend =</span> mean<span class="sc">$</span>mean <span class="sc">+</span> <span class="fl">0.0015</span>))<span class="sc">+</span></span>
<span id="cb60-18"><a href="Chapter2.html#cb60-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb60-19"><a href="Chapter2.html#cb60-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb60-20"><a href="Chapter2.html#cb60-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-movave1"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-movave1-1.png" alt="Visualization of the process of the moving average. A target value of depth = 2500 was chosen." width="432" />
<p class="caption">
図2.8: Visualization of the process of the moving average. A target value of depth = 2500 was chosen.
</p>
</div>
<p><br/></p>
<p>これを一定間隔のデータで行ってつなげると、移動平均に基づいて平滑化曲線を描くことができる(図<a href="Chapter2.html#fig:fig-movave2">2.9</a>)。</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="Chapter2.html#cb61-1" tabindex="-1"></a>Depth_n <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">810</span>, <span class="dv">4800</span>, <span class="at">by =</span> <span class="dv">10</span>)</span>
<span id="cb61-2"><a href="Chapter2.html#cb61-2" tabindex="-1"></a>Mean_n <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> Depth_n,</span>
<span id="cb61-3"><a href="Chapter2.html#cb61-3" tabindex="-1"></a>                     <span class="at">Est =</span> <span class="cn">NA</span>)</span>
<span id="cb61-4"><a href="Chapter2.html#cb61-4" tabindex="-1"></a></span>
<span id="cb61-5"><a href="Chapter2.html#cb61-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(Depth_n)){</span>
<span id="cb61-6"><a href="Chapter2.html#cb61-6" tabindex="-1"></a>  fish <span class="sc">%&gt;%</span> </span>
<span id="cb61-7"><a href="Chapter2.html#cb61-7" tabindex="-1"></a>    <span class="fu">filter</span>(MeanDepth <span class="sc">&gt;=</span> Depth_n[i] <span class="sc">-</span> <span class="dv">500</span> <span class="sc">&amp;</span> MeanDepth <span class="sc">&lt;=</span> Depth_n[i] <span class="sc">+</span> <span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb61-8"><a href="Chapter2.html#cb61-8" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Dens)) <span class="ot">-&gt;</span> mean_i</span>
<span id="cb61-9"><a href="Chapter2.html#cb61-9" tabindex="-1"></a>  </span>
<span id="cb61-10"><a href="Chapter2.html#cb61-10" tabindex="-1"></a>  Mean_n[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> mean_i<span class="sc">$</span>mean</span>
<span id="cb61-11"><a href="Chapter2.html#cb61-11" tabindex="-1"></a>}</span>
<span id="cb61-12"><a href="Chapter2.html#cb61-12" tabindex="-1"></a></span>
<span id="cb61-13"><a href="Chapter2.html#cb61-13" tabindex="-1"></a>fish <span class="sc">%&gt;%</span> </span>
<span id="cb61-14"><a href="Chapter2.html#cb61-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> Dens))<span class="sc">+</span></span>
<span id="cb61-15"><a href="Chapter2.html#cb61-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb61-16"><a href="Chapter2.html#cb61-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> Mean_n,</span>
<span id="cb61-17"><a href="Chapter2.html#cb61-17" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> Est),</span>
<span id="cb61-18"><a href="Chapter2.html#cb61-18" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb61-19"><a href="Chapter2.html#cb61-19" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb61-20"><a href="Chapter2.html#cb61-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb61-21"><a href="Chapter2.html#cb61-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-movave2"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-movave2-1.png" alt="Estimated moving average smoother" width="432" />
<p class="caption">
図2.9: Estimated moving average smoother
</p>
</div>
</div>
<div id="局所回帰loess" class="section level4 hasAnchor" number="2.2.4.2">
<h4><span class="header-section-number">2.2.4.2</span> 局所回帰(LOESS)<a href="Chapter2.html#局所回帰loess" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>移動平均ではギザギラのラインが推定されるが、LOESSではよりスムーズなラインを引くことができる。局所回帰は推定値を求めたいポイントの前後にある特定の範囲(あるいは個数?)のデータだけを用いて多項式回帰を行い(多くのソフトでデフォルトでは2次の項までを含む)、その予測値を推定値とする方法である。移動平均と同様に一定間隔のポイントに対してこれを行うことで、平滑化した曲線を描く。</p>
<p>Rでは、<code>loess</code>関数で推定を行うことができる。<code>span =</code>で各ポイントでの推定に用いるデータの割合を指定できる(デフォルトは0.75)。図<a href="Chapter2.html#fig:fig-fit-loess">2.10</a>はspanを0.1, 0.5, 1にした場合に描けるモデルから推定された平滑化曲線である。1のときは、全データを使用した多項式回帰と同じ結果である。移動平均でもLOESSでも、推定を行う際に使用するデータの範囲を変えると結果も大きく変わるので注意が必要である。</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="Chapter2.html#cb62-1" tabindex="-1"></a>M2_3_a <span class="ot">&lt;-</span> <span class="fu">loess</span>(Dens <span class="sc">~</span> MeanDepth, <span class="at">data =</span> fish, <span class="at">span =</span> <span class="fl">0.1</span>)</span>
<span id="cb62-2"><a href="Chapter2.html#cb62-2" tabindex="-1"></a>M2_3_b <span class="ot">&lt;-</span> <span class="fu">loess</span>(Dens <span class="sc">~</span> MeanDepth, <span class="at">data =</span> fish, <span class="at">span =</span> <span class="fl">0.5</span>)</span>
<span id="cb62-3"><a href="Chapter2.html#cb62-3" tabindex="-1"></a>M2_3_c <span class="ot">&lt;-</span> <span class="fu">loess</span>(Dens <span class="sc">~</span> MeanDepth, <span class="at">data =</span> fish, <span class="at">span =</span> <span class="dv">1</span>)</span>
<span id="cb62-4"><a href="Chapter2.html#cb62-4" tabindex="-1"></a></span>
<span id="cb62-5"><a href="Chapter2.html#cb62-5" tabindex="-1"></a>pred_M2_3_a <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2_3_a, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-6"><a href="Chapter2.html#cb62-6" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="Chapter2.html#cb62-7" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-8"><a href="Chapter2.html#cb62-8" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-9"><a href="Chapter2.html#cb62-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">upper =</span> fit <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-10"><a href="Chapter2.html#cb62-10" tabindex="-1"></a>         <span class="at">lower =</span> fit <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-11"><a href="Chapter2.html#cb62-11" tabindex="-1"></a>         <span class="at">span =</span> <span class="fl">0.1</span>)</span>
<span id="cb62-12"><a href="Chapter2.html#cb62-12" tabindex="-1"></a></span>
<span id="cb62-13"><a href="Chapter2.html#cb62-13" tabindex="-1"></a>pred_M2_3_b <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2_3_b, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-14"><a href="Chapter2.html#cb62-14" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-15"><a href="Chapter2.html#cb62-15" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-16"><a href="Chapter2.html#cb62-16" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-17"><a href="Chapter2.html#cb62-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">upper =</span> fit <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-18"><a href="Chapter2.html#cb62-18" tabindex="-1"></a>         <span class="at">lower =</span> fit <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-19"><a href="Chapter2.html#cb62-19" tabindex="-1"></a>         <span class="at">span =</span> <span class="fl">0.5</span>)</span>
<span id="cb62-20"><a href="Chapter2.html#cb62-20" tabindex="-1"></a></span>
<span id="cb62-21"><a href="Chapter2.html#cb62-21" tabindex="-1"></a>pred_M2_3_c <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2_3_c, <span class="at">se =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-22"><a href="Chapter2.html#cb62-22" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-23"><a href="Chapter2.html#cb62-23" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb62-24"><a href="Chapter2.html#cb62-24" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">data.frame</span>(<span class="at">MeanDepth =</span> <span class="fu">seq</span>(<span class="dv">800</span>, <span class="dv">4865</span>, <span class="at">length.out =</span> <span class="dv">100</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb62-25"><a href="Chapter2.html#cb62-25" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">upper =</span> fit <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-26"><a href="Chapter2.html#cb62-26" tabindex="-1"></a>         <span class="at">lower =</span> fit <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> df)<span class="sc">*</span>se.fit,</span>
<span id="cb62-27"><a href="Chapter2.html#cb62-27" tabindex="-1"></a>         <span class="at">span =</span> <span class="dv">1</span>) </span>
<span id="cb62-28"><a href="Chapter2.html#cb62-28" tabindex="-1"></a></span>
<span id="cb62-29"><a href="Chapter2.html#cb62-29" tabindex="-1"></a><span class="fu">bind_rows</span>(pred_M2_3_a, pred_M2_3_b, pred_M2_3_c) <span class="sc">%&gt;%</span> </span>
<span id="cb62-30"><a href="Chapter2.html#cb62-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">span =</span> <span class="fu">str_c</span>(<span class="st">&quot;span = &quot;</span>, span)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-31"><a href="Chapter2.html#cb62-31" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MeanDepth, <span class="at">y =</span> fit))<span class="sc">+</span></span>
<span id="cb62-32"><a href="Chapter2.html#cb62-32" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb62-33"><a href="Chapter2.html#cb62-33" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper),</span>
<span id="cb62-34"><a href="Chapter2.html#cb62-34" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb62-35"><a href="Chapter2.html#cb62-35" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> fish,</span>
<span id="cb62-36"><a href="Chapter2.html#cb62-36" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> Dens),</span>
<span id="cb62-37"><a href="Chapter2.html#cb62-37" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb62-38"><a href="Chapter2.html#cb62-38" tabindex="-1"></a>  <span class="fu">facet_rep_wrap</span>(<span class="sc">~</span> span)<span class="sc">+</span></span>
<span id="cb62-39"><a href="Chapter2.html#cb62-39" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">12</span>)<span class="sc">+</span></span>
<span id="cb62-40"><a href="Chapter2.html#cb62-40" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">aspect.ratio =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb62-41"><a href="Chapter2.html#cb62-41" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mean Depth&quot;</span>, <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">&quot;Fish density&quot;</span>,<span class="st">&quot; &quot;</span>, (m<span class="sc">^</span><span class="dv">2</span>))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-fit-loess"></span>
<img src="Introduction-to-GAM-using-R_files/figure-html/fig-fit-loess-1.png" alt="LOESS smoother using a span of 0.1, 0.5, and 1." width="1152" />
<p class="caption">
図2.10: LOESS smoother using a span of 0.1, 0.5, and 1.
</p>
</div>
</div>
</div>
<div id="packages-for-smoothing" class="section level3 hasAnchor" number="2.2.5">
<h3><span class="header-section-number">2.2.5</span> 2.2.5 Packages for smoothing<a href="Chapter2.html#packages-for-smoothing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rには、平滑化を行うことができるパッケージが複数存在する。例えば、<code>gam</code>パッケージ<span class="citation">(<a href="#ref-Hastie2018">Hastie &amp; Hastie, 2018</a>)</span>、<code>mgcv</code>パッケージ<span class="citation">(<a href="#ref-Wood2007">Wood &amp; EPSRC, 2007</a>)</span>、<code>gamlss</code>パッケージ<span class="citation">(<a href="#ref-Rigby2019">Rigby et al., 2019</a>)</span>などがある。それぞれのパッケージに長所と短所があり、<code>gam</code>はLOESSを用いる際に使いやすく、<code>mgvc</code>はより発展的な手法に対して使いやすい。<code>gamlss</code>はより広い分布に対して用いることができる。本稿では主に<code>mgcv</code>パッケージを用いる。</p>
<p><code>mgvc</code>パッケージでは様々な手法を用いた平滑化を行うことができるが、自身のデータに対してどの方法を用いるかを決めるためにはこうした手法について知っていなければならない。こうした手法については、第(<a href="#c3"><strong>??</strong></a>)章で詳しく学ぶ。</p>
</div>
</div>
<div id="allpying-gam-in-r-using-the-mgcv-package" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> 2.3 Allpying GAM in R using the mgcv package<a href="Chapter2.html#allpying-gam-in-r-using-the-mgcv-package" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>本節では、<code>mgvc</code>パッケージを用いてGAMを適用する方法を学ぶ。まず、<code>gam</code>関数を用いて式<a href="Chapter2.html#eq:gam">(2.1)</a>を以下のように適用する。なお、<code>fx = TRUE</code>、<code>k = 5</code>というのは有効自由度4の平滑化関数が用いられていることを示しているが、詳しくは次章で説明する。</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="Chapter2.html#cb63-1" tabindex="-1"></a>M2_4 <span class="ot">&lt;-</span> <span class="fu">gam</span>(Dens <span class="sc">~</span> <span class="fu">s</span>(MeanDepth, <span class="at">fx =</span> <span class="cn">TRUE</span>, <span class="at">k =</span> <span class="dv">5</span>),</span>
<span id="cb63-2"><a href="Chapter2.html#cb63-2" tabindex="-1"></a>            <span class="at">data =</span> fish)</span></code></pre></div>
<p><code>gam</code>関数はthin plate regression splineといわれる方法を用いている。有効自由度は曲線の形を決める値であり(calibration value)、1だと直線になり大きくなるほどより非線形な形になる。自由度4は古典的なパッケージでデフォルトとしてよく使われている値であり、推定された曲線は3次の項までを含む多項式回帰によるものと似ている。次節(<a href="#s2-4"><strong>??</strong></a>)ではcross validationを用いてどの自由度が最も適切か決める方法を学ぶ。</p>
<p><code>summary</code>関数でモデルの結果の概要を得ることができる。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="Chapter2.html#cb64-1" tabindex="-1"></a><span class="fu">summary</span>(M2_4)</span></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## Dens ~ s(MeanDepth, fx = TRUE, k = 5)
## 
## Parametric coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0046888  0.0003591   13.06   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##              edf Ref.df     F p-value    
## s(MeanDepth)   4      4 22.45  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.369   Deviance explained = 38.6%
## GCV = 1.9752e-05  Scale est. = 1.9085e-05  n = 148</code></pre>
<p>切片の推定値は0.0046888</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-Bailey2009" class="csl-entry">
Bailey, D. M., Collins, M. A., Gordon, J. D. M., Zuur, A. F., &amp; Priede, I. G. (2009). Long-term changes in deep-water fish populations in the northeast atlantic: A deeper reaching effect of fisheries? <em>Proc. Biol. Sci.</em>, <em>276</em>(1664), 1965–1969.
</div>
<div id="ref-Hastie2018" class="csl-entry">
Hastie, T., &amp; Hastie, M. T. (2018). Package <span>“gam.”</span> <em>GAM Package CRAN, Cran. R-Project. Org/Web/Packages/Gam/Gam. Pdf</em>.
</div>
<div id="ref-Rigby2019" class="csl-entry">
Rigby, R. A., Stasinopoulos, M. D., Heller, G. Z., &amp; De Bastiani, F. (2019). <em>Distributions for modeling location, scale, and shape: Using <span>GAMLSS</span> in <span>R</span></em>. CRC Press.
</div>
<div id="ref-Wood2007" class="csl-entry">
Wood, S., &amp; EPSRC, P. funded by. (2007). <em><span>R</span> mgcv-package</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sessioninfo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
